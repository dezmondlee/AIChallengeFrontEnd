import streamlit as st
import subprocess

# Streamlit UI
st.markdown(
    "<h1 style='text-align: center; '>Ice Cream Classification Guide</h1>", unsafe_allow_html=True
)

st.markdown(
    "<h6 style='text-align: center; color: #FFA500 '>Protect The Ice Cream!</h6>",
    unsafe_allow_html=True
)

st.write("This application classifies sentences based on the provided classification guide.")

# Text area for the document to be classified
document_text = st.text_area("Enter the document text here (end each sentence with 'END').")

# Button to submit the document for classification
if st.button("Submit for Classification"):
    if document_text:
        # Prepare the input for the backend script
        input_data = document_text.strip() + "\nEND"  # Ensure to add "END" at the end

        # Call the backend script using subprocess
        process = subprocess.Popen(
            ["python", "backend.py"],  # Adjust the command if necessary
            stdin=subprocess.PIPE,
            stdout=subprocess.PIPE,
            stderr=subprocess.PIPE,
            text=True
        )
        
        # Communicate with the backend script
        stdout, stderr = process.communicate(input=input_data)
        
        if process.returncode == 0:
            # Display the classification results
            results = stdout.strip().splitlines()
            for result in results:
                st.write(result)  # Display each classification result
        else:
            st.error(f"Error in backend script: {stderr.strip()}")
    else:
        st.warning("Please enter text to classify.")
